<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>å°åŒ—æ·é‹è·¯ç·šè¼ªç›¤</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background: linear-gradient(135deg, #0f172a, #1e3a8a);
      color: #fff;
    }
    .container {
      text-align: center;
      position: relative;
      width: 500px;
    }
    canvas {
      border-radius: 50%;
      background: #1e293b;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
      display: block;
      margin: 0 auto;
    }
    #pointer {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-bottom: 30px solid #facc15;
      z-index: 10;
    }
    #result {
      margin-top: 20px;
      font-size: 20px;
      font-weight: bold;
      color: #38bdf8;
    }
    button {
      margin-top: 20px;
      padding: 12px 24px;
      font-size: 16px;
      background-color: #38bdf8;
      color: #0f172a;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background-color: #0ea5e9;
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="pointer"></div>
    <canvas id="wheelCanvas" width="500" height="500"></canvas>
    <button id="spinButton">æŠ½è·¯ç·š</button>
    <div id="result"></div>
  </div>

  <script>
    const canvas = document.getElementById("wheelCanvas");
    const ctx = canvas.getContext("2d");
    const result = document.getElementById("result");
    const btn = document.getElementById("spinButton");
    const radius = canvas.width / 2;

    const lines = ["æ·¡æ°´ä¿¡ç¾©ç·š", "æ¿å—ç·š", "ä¸­å’Œæ–°è˜†ç·š", "æ¾å±±æ–°åº—ç·š", "æ–‡æ¹–ç·š"];
    const colorMap = {
      "æ·¡æ°´ä¿¡ç¾©ç·š": ["#dc2626", "#b91c1c"],
      "æ¿å—ç·š": ["#2563eb", "#1e40af"],
      "ä¸­å’Œæ–°è˜†ç·š": ["#facc15", "#ca8a04"],
      "æ¾å±±æ–°åº—ç·š": ["#16a34a", "#065f46"],
      "æ–‡æ¹–ç·š": ["#92400e", "#78350f"]
    };

    const stationsMap = {
      "æ·¡æ°´ä¿¡ç¾©ç·š": ["æ·¡æ°´", "ç´…æ¨¹æ—", "ç«¹åœ", "é—œæ¸¡", "å¿ ç¾©", "å¾©èˆˆå´—", "æ–°åŒ—æŠ•", "åŒ—æŠ•", "å¥‡å²©", "å”­å“©å²¸", "çŸ³ç‰Œ", "æ˜å¾·", "èŠå±±", "å£«æ—", "åŠæ½­", "åœ“å±±", "æ°‘æ¬Šè¥¿è·¯", "é›™é€£", "ä¸­å±±", "å°åŒ—è»Šç«™", "å°å¤§é†«é™¢", "ä¸­æ­£ç´€å¿µå ‚", "æ±é–€", "å¤§å®‰æ£®æ—å…¬åœ’", "å¤§å®‰", "ä¿¡ç¾©å®‰å’Œ", "å°åŒ—101/ä¸–è²¿", "è±¡å±±"],
      "æ¿å—ç·š": ["é ‚åŸ”", "æ°¸å¯§", "åœŸåŸ", "æµ·å±±", "äºæ±é†«é™¢", "åºœä¸­", "æ¿æ©‹", "æ–°åŸ”", "æ±Ÿå­ç¿ ", "é¾å±±å¯º", "è¥¿é–€", "å–„å°å¯º", "å¿ å­æ–°ç”Ÿ", "å¿ å­å¾©èˆˆ", "å¿ å­æ•¦åŒ–", "åœ‹çˆ¶ç´€å¿µé¤¨", "å¸‚æ”¿åºœ", "æ°¸æ˜¥", "å¾Œå±±åŸ¤", "æ˜†é™½", "å—æ¸¯", "å—æ¸¯å±•è¦½é¤¨"],
      "ä¸­å’Œæ–°è˜†ç·š": ["å—å‹¢è§’", "æ™¯å®‰", "æ°¸å®‰å¸‚å ´", "é ‚æºª", "å¤äº­", "æ±é–€", "å¿ å­æ–°ç”Ÿ", "æ¾æ±Ÿå—äº¬", "è¡Œå¤©å®®", "ä¸­å±±åœ‹å°", "æ°‘æ¬Šè¥¿è·¯", "å¤§æ©‹é ­", "å°åŒ—æ©‹", "èœå¯®", "ä¸‰é‡", "å…ˆå—‡å®®", "é ­å‰åº„", "æ–°èŠ", "è¼”å¤§", "ä¸¹é³³", "è¿´é¾"],
      "æ¾å±±æ–°åº—ç·š": ["æ–°åº—", "æ–°åº—å€å…¬æ‰€", "ä¸ƒå¼µ", "å°ç¢§æ½­", "å¤§åªæ—", "æ™¯ç¾", "è¬éš†", "å…¬é¤¨", "å°é›»å¤§æ¨“", "å¤äº­", "ä¸­æ­£ç´€å¿µå ‚", "å°å—é–€", "è¥¿é–€", "åŒ—é–€", "ä¸­å±±", "æ¾æ±Ÿå—äº¬", "å—äº¬å¾©èˆˆ", "å°åŒ—å°å·¨è›‹", "å—äº¬ä¸‰æ°‘", "æ¾å±±"],
      "æ–‡æ¹–ç·š": ["å‹•ç‰©åœ’", "æœ¨æŸµ", "è¬èŠ³ç¤¾å€", "è¬èŠ³é†«é™¢", "è¾›äº¥", "éºŸå…‰", "å…­å¼µçŠ", "ç§‘æŠ€å¤§æ¨“", "å¤§å®‰", "å¿ å­å¾©èˆˆ", "å—äº¬å¾©èˆˆ", "ä¸­å±±åœ‹ä¸­", "æ¾å±±æ©Ÿå ´", "å¤§ç›´", "åŠå—è·¯", "è¥¿æ¹–", "æ¸¯å¢˜", "æ–‡å¾·", "å…§æ¹–", "å¤§æ¹–å…¬åœ’", "è‘«æ´²", "æ±æ¹–", "å—æ¸¯è»Ÿé«”åœ’å€", "å—æ¸¯å±•è¦½é¤¨"]
    };

    let items = lines;
    let isFinal = false;
    let rotation = 0;
    let spinning = false;
    let currentColors = null;

    function drawWheel() {
      const arc = (2 * Math.PI) / items.length;
      for (let i = 0; i < items.length; i++) {
        const angle = i * arc;
        ctx.beginPath();
        let fill = "#ccc";
        if (currentColors) {
          fill = i % 2 === 0 ? currentColors[0] : currentColors[1];
        } else {
          const gray = 180 + i * 10;
          fill = `rgb(${gray},${gray},${gray})`;
        }
        ctx.fillStyle = fill;
        ctx.moveTo(radius, radius);
        ctx.arc(radius, radius, radius, angle, angle + arc, false);
        ctx.fill();

        ctx.save();
        ctx.fillStyle = "#000";
        ctx.translate(radius + Math.cos(angle + arc / 2) * radius * 0.65,
                      radius + Math.sin(angle + arc / 2) * radius * 0.65);
        ctx.rotate(angle + arc / 2 + Math.PI / 2);
        ctx.textAlign = "center";
        ctx.font = items.length <= 20 ? "16px sans-serif" : "12px sans-serif";
        ctx.fillText(items[i], 0, 0);
        ctx.restore();
      }
    }

    function spinWheel() {
      if (spinning) return;
      spinning = true;
      result.textContent = "";
      const arc = (2 * Math.PI) / items.length;
      const spins = 5 + Math.random() * 5;
      const finalAngle = rotation + spins * 2 * Math.PI;
      const duration = 3000;
      const startTime = performance.now();

      function animate(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        const ease = 1 - Math.pow(1 - progress, 3);
        rotation = rotation + (finalAngle - rotation) * ease;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.save();
        ctx.translate(radius, radius);
        ctx.rotate(rotation);
        ctx.translate(-radius, -radius);
        drawWheel();
        ctx.restore();

        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          spinning = false;
          const normalizedRotation = (rotation % (2 * Math.PI) + 2 * Math.PI) % (2 * Math.PI);
          const pointerAngle = (3 * Math.PI / 2 - normalizedRotation + 2 * Math.PI) % (2 * Math.PI);
          const index = Math.floor(pointerAngle / arc);
          const selected = items[index];
          result.textContent = `ğŸ¯ æœ¬æ¬¡æŠ½åˆ°ï¼š${selected}`;

          if (!isFinal) {
            items = stationsMap[selected];
            isFinal = true;
            currentColors = colorMap[selected] || null;
            btn.textContent = "æŠ½ç«™å";
            rotation = 0;
            setTimeout(() => {
              ctx.clearRect(0, 0, canvas.width, canvas.height);
              drawWheel();
              result.textContent += "ï¼Œè«‹å†è½‰ä¸€æ¬¡ï¼";
            }, 1000);
          }
        }
      }

      requestAnimationFrame(animate);
    }

    drawWheel();
    btn.addEventListener("click", spinWheel);
  </script>
</body>
</html>
